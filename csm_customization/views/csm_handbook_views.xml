<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Tree View -->
    <record id="view_csm_handbook_tree" model="ir.ui.view">
        <field name="name">csm.handbook.tree</field>
        <field name="model">csm.handbook</field>
        <field name="arch" type="xml">
            <tree>
                <!--                <field name="name"/>-->
                <field name="customer_id"/>
                <field name="manager_id"/>
                <field name="month"/>
                <field name="gar" widget="badge"
                       decoration-success="gar == 'green'"
                       decoration-warning="gar == 'amber'"
                       decoration-danger="gar == 'red'"/>
                <field name="current_meeting_frequency"/>
            </tree>
        </field>
    </record>

    <!-- Form View -->
    <record id="view_csm_handbook_form" model="ir.ui.view">
        <field name="name">csm.handbook.form</field>
        <field name="model">csm.handbook</field>
        <field name="arch" type="xml">
            <form>
                <header>
<!--                    <div class="oe_button_box" name="button_box">-->
                        <button name="action_view_calendar_event" type="object" class="oe_stat_button" icon="fa-calendar" attrs="{'invisible': [('calendar_event_id', '=', False)]}">
                            <span>Meeting</span>
                        </button>
<!--                    </div>-->
                </header>
                <sheet>
                    <!-- Banner -->
                    <widget name="web_ribbon" title="GREEN"
                            bg_color="bg-success"
                            attrs="{'invisible': [('gar', '!=', 'green')]}"/>
                    <widget name="web_ribbon" title="AMBER"
                            bg_color="bg-warning"
                            attrs="{'invisible': [('gar', '!=', 'amber')]}"/>
                    <widget name="web_ribbon" title="RED"
                            bg_color="bg-danger"
                            attrs="{'invisible': [('gar', '!=', 'red')]}"/>
                    <group>
                        <group>
                            <!--                            <field name="name"/>-->
                            <field name="customer_id" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="manager_id"
                                   domain="[('parent_id', '=', customer_id), ('parent_id', '!=', False)]"
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="manager_email"/>
                            <field name="month"/>
                            <field name="current_month_schedule"/>
                        </group>
                        <group>
                            <!--                            <field name="suggested_meeting_frequency"/>-->
                            <field name="current_meeting_frequency"/>
                            <field name="client_attend_call"/>
                            <field name="business_tech"/>
                            <field name="gar"/>
                            <field name="is_meeting_done"/>
                            <field name="is_meeting_rescheduled"/>
                            <field name="calendar_event_id" invisible="1"/>
                        </group>
                    </group>
                    <!--                    <group>-->
                    <!--                        <field name="gar_comment"/>-->
                    <!--                    </group>-->
                    <notebook>
                        <page string="Action Steps">
                            <field name="action_amber_red" placeholder="Type '/' for commands"/>
                        </page>
                        <page string="Task Assignment">
                            <field name="task_assign_line_ids">
                                <tree editable="bottom">
                                    <field name="reason"/>
                                    <field name="to_employee_ids" widget="many2many_tags"/>
                                    <field name="cc_employee_ids" widget="many2many_tags"/>
                                    <field name="priority" widget="priority"/>
                                    <field name="assign_date"/>
                                    <field name="csm_task_confirmed"/>
                                    <button name="action_send_action_mail" type="object" class="oe_highlight" string="Send Email" icon="fa-envelope"/>
                                </tree>
                                <form>
                                    <sheet>
                                        <group>
                                            <group>
                                                <field name="reason"/>
                                                <field name="action_taken_comment"/>
                                                <field name="priority"/>
                                                <field name="assign_date"/>
                                            </group>
                                            <group>
                                                <field name="to_employee_ids"/>
                                                <field name="cc_employee_ids"/>
                                                <field name="csm_task_confirmed"/>
                                                <field name="confirmed_date"/>
                                            </group>
                                        </group>
                                        <div class="oe_button_box">
                                            <button name="action_send_action_mail" type="object" class="oe_highlight" string="Send Email"/>
                                        </div>
                                    </sheet>
                                    <div class="oe_chatter">
                                        <field name="message_follower_ids"/>
                                        <field name="activity_ids"/>
                                        <field name="message_ids"/>
                                    </div>
                                </form>
                            </field>
                        </page>
                        <page string="Notes">
                            <field name="notes" placeholder="Type '/' for commands"/>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" groups="base.group_user"
                           options="{'post_refresh': 'recipients'}"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <!-- Search View -->
    <record id="view_csm_handbook_search" model="ir.ui.view">
        <field name="name">csm.handbook.search</field>
        <field name="model">csm.handbook</field>
        <field name="arch" type="xml">
            <search>
                <!--                <field name="name"/>-->
                <field name="customer_id"/>
                <field name="manager_id"/>
                <filter string="Green" name="green" domain="[('gar', '=', 'green')]"/>
                <filter string="Amber" name="amber" domain="[('gar', '=', 'amber')]"/>
                <filter string="Red" name="red" domain="[('gar', '=', 'red')]"/>
                <group expand="0" string="Group By">
                    <filter string="Manager" name="group_manager" context="{'group_by': 'manager_id'}"/>
                    <filter string="Customer" name="group_customer" context="{'group_by': 'customer_id'}"/>
                    <filter string="GAR" name="group_gar" context="{'group_by': 'gar'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Action -->
    <record id="action_csm_handbook" model="ir.actions.act_window">
        <field name="name">CSM Handbook</field>
        <field name="res_model">csm.handbook</field>
        <field name="view_mode">tree,form</field>
        <!--        <field name="help" type="html">-->
        <!--            <p class="o_view_nocontent_smiling_face">-->
        <!--                Create your first CSM Handbook entry-->
        <!--            </p>-->
        <!--        </field>-->
    </record>

    <!-- Menu -->
    <!--    <menuitem id="menu_csm_handbook_root" name="CSM Handbook" sequence="10"/>-->
    <!--    <menuitem id="menu_csm_handbook" name="Handbook" parent="menu_csm_handbook_root" action="action_csm_handbook" sequence="10"/>-->
</odoo>
