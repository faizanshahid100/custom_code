<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="csm_customization.CSMDashboard" owl="1">
        <div class="csm-dashboard">
            <div class="dashboard-header">
                <h2>Welcome Administrator ðŸ‘‹</h2>
                <div class="dashboard-controls">
                    <select class="form-select">
                        <option>This Month</option>
                    </select>
                </div>
            </div>

            <div t-if="state.loading" class="text-center p-4">
                <i class="fa fa-spinner fa-spin fa-2x"/>
                <p>Loading dashboard...</p>
            </div>

            <div t-else="" class="dashboard-content">
                <!-- Top Banner -->
                <div class="row mb-3">
                    <div class="col-12">
                        <div class="widget-card bg-primary text-white p-4 text-center" 
                             t-on-click="() => this.onWidgetClick('total_meetings')">
                            <i class="fa fa-calendar fa-2x mb-2"/>
                            <h1 t-esc="state.dashboardData.total_meetings"/>
                            <p>Number of Meetings</p>
                        </div>
                    </div>
                </div>

                <!-- 3x3 Grid Layout -->
                <div class="row mb-3">
                    <!-- Row 1 -->
                    <div class="col-md-4">
                        <div class="widget-card bg-danger text-white p-3 text-center"
                             t-on-click="() => this.onWidgetClick('red_zone')">
                            <i class="fa fa-chart-bar fa-2x mb-2"/>
                            <h3>Red Zone</h3>
                            <h2 t-esc="state.dashboardData.gar_counts.red"/>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="widget-card p-3 text-center"
                             t-on-click="() => this.onWidgetClick('client_satisfaction')">
                            <i class="fa fa-chart-line fa-2x mb-2"/>
                            <h6>Client Satisfaction Survey</h6>
                            <h4 t-esc="state.dashboardData.client_satisfaction.satisfied + '/' + state.dashboardData.client_satisfaction.total"/>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="widget-card p-3 text-center"
                             t-on-click="() => this.onWidgetClick('clients_red_zone')">
                            <i class="fa fa-chart-line fa-2x mb-2"/>
                            <h6>Clients in Red Zone</h6>
                            <h4 t-esc="state.dashboardData.gar_counts.red"/>
                        </div>
                    </div>
                </div>

                <div class="row mb-3">
                    <!-- Row 2 -->
                    <div class="col-md-4">
                        <div class="widget-card bg-warning text-white p-3 text-center"
                             t-on-click="() => this.onWidgetClick('amber_zone')">
                            <i class="fa fa-chart-bar fa-2x mb-2"/>
                            <h3>Amber</h3>
                            <h2 t-esc="state.dashboardData.gar_counts.amber"/>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="widget-card p-3 text-center"
                             t-on-click="() => this.onWidgetClick('overdue_meetings')">
                            <i class="fa fa-clock fa-2x mb-2"/>
                            <h6>Overdue Meetings</h6>
                            <h4 t-esc="state.dashboardData.overdue_meetings"/>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="widget-card p-3 text-center"
                             t-on-click="() => this.onWidgetClick('client_feedback')">
                            <i class="fa fa-comments fa-2x mb-2"/>
                            <h6>Client Feedback CSM</h6>
                            <h4 t-esc="state.dashboardData.client_feedback.positive + '/' + state.dashboardData.client_feedback.total"/>
                        </div>
                    </div>
                </div>

                <div class="row mb-3">
                    <!-- Row 3 -->
                    <div class="col-md-4">
                        <div class="widget-card bg-success text-white p-3 text-center"
                             t-on-click="() => this.onWidgetClick('green_zone')">
                            <i class="fa fa-chart-bar fa-2x mb-2"/>
                            <h3>Green</h3>
                            <h2 t-esc="state.dashboardData.gar_counts.green"/>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="widget-card p-3 text-center"
                             t-on-click="() => this.onWidgetClick('completed_meetings')">
                            <i class="fa fa-check-circle fa-2x mb-2"/>
                            <h6>Completed Meetings</h6>
                            <h4 t-esc="state.dashboardData.completed_meetings"/>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="widget-card p-3 text-center"
                             t-on-click="() => this.onWidgetClick('no_show_today')">
                            <i class="fa fa-user-times fa-2x mb-2"/>
                            <h6>NO SHOW(Today)</h6>
                            <h4 t-esc="state.dashboardData.no_show_today.no_show + '/' + state.dashboardData.no_show_today.total"/>
                        </div>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="widget-card p-3">
                            <h6>Client Wise Meetings</h6>
                            <div class="chart-placeholder" style="height: 200px; background: #f8f9fa; display: flex; align-items: center; justify-content: center;">
                                <span class="text-muted">Chart will be rendered here</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="widget-card p-3">
                            <h6>Monthly Meeting Trends</h6>
                            <div class="chart-placeholder" style="height: 200px; background: #f8f9fa; display: flex; align-items: center; justify-content: center;">
                                <span class="text-muted">Chart will be rendered here</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Task Escalations -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="widget-card p-3">
                            <h6>CSM - Escalations</h6>
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>Task Priority</th>
                                            <th>Reason Details</th>
                                            <th>Assign Date</th>
                                            <th>Last Modified on</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr t-foreach="state.dashboardData.task_escalations" t-as="task" t-key="task.id"
                                            t-on-click="() => this.onWidgetClick('task_escalations')" style="cursor: pointer;">
                                            <td t-esc="task.priority"/>
                                            <td t-esc="task.reason"/>
                                            <td t-esc="task.assign_date"/>
                                            <td t-esc="task.last_modified"/>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="widget-card p-3">
                            <h6>CSM - Upcoming Meetings</h6>
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>Customer</th>
                                            <th>Manager</th>
                                            <th>Meeting Date</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr t-foreach="state.dashboardData.upcoming_meetings" t-as="meeting" t-key="meeting.id">
                                            <td t-esc="meeting.customer"/>
                                            <td t-esc="meeting.manager"/>
                                            <td t-esc="meeting.date"/>
                                            <td t-esc="meeting.status"/>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </t>
</templates>
